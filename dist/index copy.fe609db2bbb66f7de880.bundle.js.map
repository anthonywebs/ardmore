{"version":3,"file":"index copy.fe609db2bbb66f7de880.bundle.js","mappings":"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","sources":["webpack:///./js/index copy.js"],"sourcesContent":["let runDraw = undefined; // draw closure\n\nconst runEveryX = freq => {\n    let count = 0;\n    return () => {\n        count = (count + 1) % freq;\n        return count === 0; \n    }\n}\n\nconst displayAudioEffectInit = async () => {\n  const canvas = document.getElementById('js-visualizer');\n  const context = canvas.getContext('2d');\n  canvas.width = canvas.offsetWidth;\n  canvas.height = canvas.offsetHeight;\n  const title = \"Anthony\";\n  context.font = \"192px SF_Pro_Display_Black\";\n  const titleWidth = context.measureText(title).width;\n  const canvasCoverage = canvas.width < 600 ? 0.95 : 0.85;\n  const titleRatio = canvasCoverage * (canvas.width > 1000 ? 1000 : canvas.width) / titleWidth;\n\n  const titleHeight = 192 * titleRatio;\n  const titleLeft = (canvas.width - titleWidth * titleRatio) / titleRatio / 2;\n  context.lineWidth = 1;\n  context.strokeStyle = 'rgb(255,255,255,0.6';\n\n  // backgorund white lines\n  for (let i = 0; i < canvas.width; i += 3){\n    context.beginPath();\n    context.moveTo(i, titleHeight);\n    context.lineTo(i, 0);\n    context.stroke();\n    context.closePath();    \n  }\n  context.save();\n  context.scale(titleRatio, titleRatio);\n\n  context.globalCompositeOperation = 'destination-in';         \n  context.fillText(title, titleLeft, 150);\n  context.globalCompositeOperation = 'source-over'; \n  context.restore();\n}\n\nconst displayAudioEffect = () => {\n  const canvas = document.getElementById('js-visualizer');\n  const context = canvas.getContext('2d');\n  canvas.width = canvas.offsetWidth;\n  canvas.height = canvas.offsetHeight;\n  const isMobile = canvas.width < 540;\n\n  const topCanvas = document.getElementById('js-top-visualizer');\n  const topContext = topCanvas.getContext('2d');\n  topCanvas.width = topCanvas.offsetWidth;\n  topCanvas.height = topCanvas.width;\n    \n  // Connect the audio source to the analyser node\n  const audioContext = new (window.AudioContext || window.webkitAudioContext)();\n  const analyser = audioContext.createAnalyser();\n  const audioEl = document.getElementById('js-audio');\n  const audioSource = audioContext.createMediaElementSource(audioEl);\n  audioSource.connect(analyser);\n  analyser.connect(audioContext.destination);\n\n  // Set up the analyser node\n  analyser.fftSize = 256; // default 256\n  const bufferLength = analyser.frequencyBinCount - 38; // 90\n  const dataArray = new Uint8Array(bufferLength); \n\n  const runThis = runEveryX(1); // 60fps\n\n  let prevBarHeight = ArrayBuffer[0];\n\n  const title = \"Anthony\";\n  context.font = \"192px SF_Pro_Display_Black\";\n  // context.letterSpacing = '-8px';\n  const titleWidth = context.measureText(title).width;\n  const canvasCoverage = isMobile ? 0.95 : 0.85;\n  const titleRatio = canvasCoverage * (canvas.width > 1000 ? 1000 : canvas.width) / titleWidth;\n\n  // const titleRatio = 1;\n  const titleHeight = 192 * titleRatio;\n  const titleLeft = (canvas.width - titleWidth * titleRatio) / titleRatio / 2;\n\n  let vynilAngle = 25;\n  const imgElem = document.getElementById('js-vynil');\n\n  // for small top control\n  const centerX = topCanvas.width / 2;\n  const centerY = topCanvas.height / 2;\n  const radius = isMobile ? 25 : 45; // Base radius of the circle\n  const peakFactor = isMobile ? 0.2 : 0.3; // peak length\n  const peakCount = 30; // number of points\n  const peakMod = bufferLength / peakCount;\n  const startX = 0;\n      \n    // Draw the js-visualizer\n  const draw = () => {\n    if (audioEl.paused) {\n      // pauseMusic();\n      return;\n    }\n    \n    analyser.getByteFrequencyData(dataArray);\n    imgElem.style.transform = `rotate(${vynilAngle}deg)`;\n    let vynilSpeed = dataArray[0] / 64;\n    vynilSpeed = vynilSpeed > 1 ? 1.5 : vynilSpeed;\n    \n    vynilAngle += vynilSpeed;\n    if (vynilAngle >= 360) vynilAngle = 0;\n\n    // if (runThis()) {\n    if (true) { // for now, full fames 128fps\n      context.clearRect(0, 0, canvas.width, canvas.height);\n      \n      // top control\n      topContext.clearRect(0, 0, topCanvas.width, topCanvas.height);\n\n      let x = 0;\n      if (isMobile) x = -300; // move to left when playing in mobile\n\n      context.fillStyle = '#000';            \n      context.fillRect(0, 0, canvas.width, canvas.height);\n\n      topContext.strokeStyle = '#ff5a00';\n\n      topContext.lineWidth = isMobile ? 5: 7; // circle width\n      topContext.lineJoin = \"round\";\n      // clip circle\n      topContext.beginPath();\n      topContext.arc(centerX, centerY, radius, 0, Math.PI * 2);\n      topContext.stroke();\n      topContext.closePath();\n      topContext.clip();\n\n      topContext.lineWidth = 5; // wave line width\n\n      let togglePeak = -1;\n      topContext.beginPath();\n      topContext.moveTo(startX, centerY);\n\n\n      for (let i = 0; i < bufferLength; i++) {\n        // small top control\n        if (i > 0 && i % peakMod === 0) {\n          let dist = dataArray[i];\n          dist = dist > 64 ? dist - 64 : 0; // make wave look bigger diff\n          const peakY = dist * peakFactor * togglePeak;\n          togglePeak *= -1;\n          topContext.lineTo(startX + topCanvas.width * i / bufferLength, centerY - peakY);\n        }\n\n        const barHeight = dataArray[i]/128 * titleHeight * 0.5;\n        const granCount = 9;\n        const diff = (barHeight - prevBarHeight) / granCount;\n\n        for (let i = 0; i < granCount; i++){\n          context.beginPath();\n          context.lineWidth = 1;\n          context.strokeStyle = 'rgb(255,255,255,0.6)';\n          context.moveTo(x + (i * 3), titleHeight);\n          context.lineTo(x + (i * 3), 0);\n          context.stroke();\n          context.closePath();    \n\n          context.beginPath();\n          context.lineWidth = 4;\n          context.moveTo(x + (i * 3), titleHeight);\n          context.lineTo(x + (i * 3), titleHeight - (prevBarHeight + (i * diff)));\n          context.strokeStyle = '#fff';\n          context.stroke();\n          context.closePath();    \n        }\n        prevBarHeight = barHeight;                \n        x += 27;\n      }\n\n      topContext.stroke();\n      topContext.closePath();\n\n      context.save();\n      context.scale(titleRatio, titleRatio);\n      \n      context.globalCompositeOperation = 'destination-in';        \n      context.fillText(title, titleLeft, 150);\n      context.globalCompositeOperation = 'source-over'; \n      context.restore();\n    }\n\n    requestAnimationFrame(draw);  // i don't want recursion, but no choice\n  }\n\n  return draw; // make closure\n}\n\nconst playMusic = () => {\n  const audioEl = document.getElementById('js-audio');\n  audioEl.play();\n  document.getElementById('js-play-text').classList.add('hidden');\n  document.getElementById('js-play').classList.add('hidden');\n  document.getElementById('js-top-play').classList.add('hidden');\n  document.getElementById('js-top-visualizer').classList.remove('hidden');\n  document.getElementById('js-pause').classList.remove('hidden');\n  document.getElementById('js-ff').classList.remove('hidden');\n  if (!runDraw) {\n    runDraw = displayAudioEffect();\n  }\n  runDraw();\n}\n\nconst playNext = () => {\n  const audioEl = document.getElementById('js-audio');\n  if (++SONG_TRACK === SONG_LIST.length) SONG_TRACK = 0;\n  audioEl.src = SONG_LIST[SONG_TRACK].path;\n  audioEl.play();    \n}\n\nconst pauseMusic = () => {\n  const audioEl = document.getElementById('js-audio');\n  audioEl.pause();\n  document.getElementById('js-play-text').classList.remove('hidden');\n  document.getElementById('js-pause').classList.add('hidden');\n  document.getElementById('js-ff').classList.add('hidden');\n  document.getElementById('js-top-visualizer').classList.add('hidden');\n  document.getElementById('js-top-play').classList.remove('hidden');\n  document.getElementById('js-play').classList.remove('hidden');\n}\n\nconst togglePlay = () => {\n  const audioEl = document.getElementById('js-audio');\n  if (audioEl.paused) {\n    playMusic();\n  } else {\n    pauseMusic();\n  }\n}\n\n// scroll line effect function\n// start 0.2, duration 0.2 \nconst lineEffect = (targetEl, screenHeight, start = 0.2, transition = 0.2) => {\n  let opacity = 0;\n  const top = targetEl.getBoundingClientRect().top;\n\n  if (top > 0 && top < screenHeight) {\n    if (top > screenHeight * (1 - start - transition)  && top < screenHeight * (1 - start)) {//upper bound\n      opacity = (screenHeight * (1 - start) - top)/screenHeight / transition;\n    } else if (top > screenHeight * start/2 && top < screenHeight * (start/2 + transition)) { // lower bound\n      opacity = 1  - (screenHeight * (start/2 + transition) - top)/screenHeight / transition;\n    } else if (top >= screenHeight * (start/2 + transition) && top <= screenHeight * (1 - start - transition)) {\n      opacity = 1;\n    }\n    targetEl.style.opacity = opacity;\n  }\n}\n\n// durationFr should be twice bigger than transitionFr\nconst bgEffect = (targetEl, bgEl, screenHeight, startFr = 0.5, durationFr = 1, transitionFr = 0.1, opacityWeight = 1) => {\n  let opacity = 0;\n  \n  const top = targetEl.getBoundingClientRect().top;\n  const halfHeight = screenHeight * 0.5;\n  // order end < endMid < startMid < start\n  const start = screenHeight * startFr;\n  const end = screenHeight * (startFr - durationFr);\n  const transFr = durationFr * transitionFr;\n  const trans = screenHeight * transFr;\n  const startMid = start - screenHeight * transFr;\n  const endMid = end + screenHeight * transFr;\n  \n  if (top > end - halfHeight && top < start + halfHeight) {\n    if (top > startMid && top < start) {\n      opacity = (start - top)/trans;\n    } else if (top > end && top < endMid) {\n      opacity = (top - end)/trans;\n    } else if (top >= endMid && top <= startMid) {\n      opacity = 1;\n    }\n    bgEl.style.opacity = opacity * opacityWeight;\n  }\n}\n\nconst renderIntro = () => {\n  const bodyWrEl = document.getElementById('js-body-wr');\n  const screenWidth = bodyWrEl.offsetWidth;\n  const screenHeight = bodyWrEl.offsetHeight;\n  const innerEl = document.getElementById('js-body-inner');\n  const introEl = document.getElementById('js-intro');\n  const introWidth = introEl.offsetWidth;\n  const isMobile = screenWidth < 540;\n  let targetWidth = screenWidth * (screenWidth > 600 ? 0.75 : 0.8);\n  if (screenWidth > 1200) targetWidth = 960;\n  const startRatio = targetWidth / introWidth;\n\n  let ratio = startRatio;\n  introEl.style.transform = `translate(-50%, -50%) matrix(${ratio}, 0, 0, ${ratio}, 0, 0)`;\n\n  // vynil init\n  const vynilEl = document.getElementById('js-vynil-wr');\n  const imgElem = document.getElementById('js-vynil');\n  imgElem.style.transform = 'rotate(25deg)';\n\n  // music eq init\n  displayAudioEffectInit();\n\n  const photoEl = document.getElementById('js-photo');\n  const whiteEl = document.getElementById('js-white');\n  const linksWrEl = document.getElementById('js-links-wr');\n  const musicSectionEl = document.getElementById('js-music-section');\n  // code\n  const codeEl = document.getElementById('js-code');\n  // const codeElHeight = codeEl.offsetHeight;\n  let codeTargetWidth = screenWidth * (screenWidth > 600 ? 0.8 : 0.9);\n  if (screenWidth > 1400) codeTargetWidth = 1200;\n  const codeRatio = codeTargetWidth / codeEl.offsetWidth;\n  codeEl.style.transform = `translate(-50%, -50%) matrix(${codeRatio}, 0, 0, ${codeRatio}, 0, 0)`;\n\n  const topEl = document.getElementById('js-top-audio');\n\n  // text scroll\n  const j1 = document.getElementById('js-1');\n  const j2 = document.getElementById('js-2');\n  const j3 = document.getElementById('js-3');\n\n  // scroll event\n  bodyWrEl.addEventListener('scroll', () => {\n    const vynilTop = vynilEl.getBoundingClientRect().top\n    const innerTop = innerEl.getBoundingClientRect().top;\n    const linksTop = linksWrEl.getBoundingClientRect().top;\n    const scrollAmount = (innerTop > 0 ? 0 : -innerTop) + 1;\n  \n    ratio = startRatio + startRatio * scrollAmount * 48 / screenHeight;\n    if (scrollAmount < screenHeight * 1.5) {\n      introEl.style.opacity = 1;\n\n      let bgOpacity = 0;\n      if (scrollAmount > screenHeight) {\n        bgOpacity = (scrollAmount - screenHeight)/screenHeight*2;\n        if (bgOpacity > 0.9) bgOpacity = 1;\n        if (bgOpacity < 0) bgOpacity = 0;\n      }\n      introEl.style.backgroundColor = `rgb(0, 0, 0, ${bgOpacity})`;\n      introEl.style.transform = `translate(-50%, -50%) matrix(${ratio}, 0, 0, ${ratio}, 0, 0)`;  \n    }\n\n    const startPoint = isMobile ? 0.30 : 0.2;\n    lineEffect(j1, screenHeight, startPoint, 0.2);\n    lineEffect(j2, screenHeight, startPoint, 0.2);\n    lineEffect(j3, screenHeight, startPoint, 0.2);\n    \n    // screenHeight, starting point, duration, transition time, opacity\n    bgEffect(j1, codeEl, screenHeight, 0.3, 1.35, 0.4, 0.5);\n    bgEffect(j2, photoEl, screenHeight, 1.3, 1.45, 0.4, 0.9);\n    bgEffect(j3, musicSectionEl, screenHeight, 0.3, 1.1, 0.3, 1);\n\n    // white link page\n    if (linksTop < screenHeight && linksTop > 0) {\n      let opacity = 0;\n      const opacityStart = screenHeight * 0.6;  // link starting to show\n      const opacityStop = screenHeight * 0.15;\n      const duration = opacityStart - opacityStop;\n\n      if (linksTop >= opacityStop && linksTop < opacityStart) {\n        opacity = 1 - (linksTop - opacityStop)/duration;\n      } else if (linksTop < opacityStop) {\n        opacity = 1;\n      }\n      // linksWrEl.style.backgroundColor = `rgba(255, 255, 255, )`\n      linksWrEl.style.opacity = opacity;\n      // musicSectionEl.style.opacity = 1 - opacity;\n      whiteEl.style.opacity = opacity;\n    }\n\n    if (vynilTop > -screenHeight * 0.5 && vynilTop < screenHeight * 0.4) {\n      topEl.style.opacity = 0;\n    } else {\n      topEl.style.opacity = 1;\n    }  \n  });\n\n}\n\nconst scrollToLinks = () => {\n  const linksWrEl = document.getElementById('js-links-wr');\n\n  // linksWrEl.scrollIntoView({ behavior: \"smooth\"});\n  linksWrEl.scrollIntoView();\n  linksWrEl.style.opacity = 1;\n  document.getElementById('js-intro').style.opacity = 0; // hide name after scrolling\n}\n\nlet count = 0 // test purpose\n\nconst startEventListener = e => {\n  const audioEl = document.getElementById('js-audio');\n\n  //form\n  document.getElementById('js-contact-form').addEventListener('submit', handleSubmit);\n\n  document.getElementById('js-play-text').addEventListener('click', playMusic);\n  document.getElementById('js-top-play').addEventListener('click', playMusic);\n  document.getElementById('js-top-play').addEventListener('dblclick', playNext);\n  document.getElementById('js-play').addEventListener('click', playMusic);\n  document.getElementById('js-top-visualizer').addEventListener('click', pauseMusic);\n  document.getElementById('js-pause').addEventListener('click', pauseMusic);\n  document.getElementById('js-ff').addEventListener('click', playNext);\n  \n  document.getElementById('js-vynil').addEventListener('click', togglePlay);\n  document.getElementById('js-visualizer').addEventListener('click', togglePlay);\n\n  document.getElementById('js-skip-intro').addEventListener('click', e => {\n    e.preventDefault();\n    scrollToLinks();\n  });\n  \n  // when the user leaves the window\n  if (document.visibilityState !== 'undefined') {\n    document.addEventListener('visibilitychange', () => {\n      if (document.visibilityState === 'hidden' && !!runDraw) {\n        // document.getElementById('js-log').textContent = `Before`;\n        localStorage.setItem('resume', 'true');\n        location.reload();\n      }  else if (document.visibilityState === 'visible' && localStorage.getItem('resume') === 'true') {\n        // document.getElementById('js-log').textContent = 'loading';\n        scrollToLinks();\n        audioEl.src = SONG_LIST[++SONG_TRACK].path;\n\n        localStorage.setItem('resume', 'false');\n      }\n    });\n  };\n\n  // if (!audioEl) return;\n  // audioEl.addEventListener('play', () => {\n  //     console.log(\"AK: started\");\n  //     // displayAudioEffect();\n  //     });\n\n  audioEl.addEventListener('ended', () => {\n    SONG_TRACK++;\n    if (SONG_TRACK === SONG_LIST.length) SONG_TRACK = 0;\n    audioEl.src = SONG_LIST[SONG_TRACK].path;\n    audioEl.play();\n  });\n\n  document.getElementById('js-body-inner').addEventListener('click', e => {\n    e.preventDefault();\n  });\n}\n\n\nconst handleSubmit = async e => {\n  e.preventDefault();\n  const form = document.getElementById('js-contact-form');\n  const data = new FormData(e.target);\n\n  try {\n    const response = await fetch(event.target.action, \n        {\n            method: 'POST',\n            body: data,\n            headers: {\n                'Accept': 'application/json',\n            },\n        }\n    );\n    \n    if (response.ok) {\n      form.reset();\n      showNotice(true);\n    } else {\n        response.json().then(data => {\n          showNotice(false);\n          console.error(\"Server error\", data);\n        });\n    }\n  } catch (error) {\n    showNotice(false);\n    console.error(\"Unknown error\", error);\n  } \n}\n\nconst makeSongTrack = () => {\n  // Function to shuffle an array (Fisher-Yates shuffle algorithm)\n  const shuffleArray = array => {\n    for (let i = array.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [array[i], array[j]] = [array[j], array[i]];\n    }\n    return array;\n  }\n  // Shuffle the array except for the first item\n  SONG_LIST = [SONG_LIST[0], ...shuffleArray(SONG_LIST.slice(1))];\n\n  const audioEl = document.getElementById('js-audio');\n  const visitCountSr = localStorage.getItem('visitCount');\n  let visitCount = visitCountSr ? parseInt(visitCountSr, 10) : 0;\n \n  if (visitCount < 1) { // visit 1st time\n    audioEl.src = './media/intro_voicebooking.m4a';\n  } else if (visitCount < 2) { // visit 2nd time or less\n    SONG_TRACK++;\n    audioEl.src = SONG_LIST[SONG_TRACK].path;\n  } else {\n    SONG_LIST.sort((a, b) => Math.random() - 0.5);\n    SONG_TRACK++;\n    audioEl.src = SONG_LIST[SONG_TRACK].path;\n    if (visitCount >= 5) visitCount = -1; // reset count\n  }\n  localStorage.setItem('visitCount', visitCount + 1);\n}\n   \nconst main = async () => {\n  await loadFont();\n  makeSongTrack();\n  renderIntro();\n  startEventListener();\n}\n\nmain();"],"names":["runDraw","playMusic","document","getElementById","play","classList","add","remove","displayAudioEffect","canvas","context","getContext","width","offsetWidth","height","offsetHeight","isMobile","topCanvas","topContext","audioContext","window","AudioContext","webkitAudioContext","analyser","createAnalyser","audioEl","createMediaElementSource","connect","destination","fftSize","bufferLength","frequencyBinCount","dataArray","Uint8Array","prevBarHeight","ArrayBuffer","title","font","titleWidth","measureText","titleRatio","titleHeight","titleLeft","vynilAngle","imgElem","centerX","centerY","radius","peakFactor","peakMod","draw","paused","getByteFrequencyData","style","transform","vynilSpeed","clearRect","x","fillStyle","fillRect","strokeStyle","lineWidth","lineJoin","beginPath","arc","Math","PI","stroke","closePath","clip","togglePeak","moveTo","i","dist","peakY","lineTo","barHeight","granCount","diff","save","scale","globalCompositeOperation","fillText","restore","requestAnimationFrame","playNext","SONG_TRACK","SONG_LIST","length","src","path","pauseMusic","pause","togglePlay","lineEffect","targetEl","screenHeight","start","transition","opacity","top","getBoundingClientRect","bgEffect","bgEl","startFr","durationFr","transitionFr","opacityWeight","halfHeight","end","transFr","trans","startMid","endMid","scrollToLinks","linksWrEl","scrollIntoView","handleSubmit","async","e","preventDefault","form","data","FormData","target","response","fetch","event","action","method","body","headers","ok","reset","showNotice","json","then","console","error","loadFont","makeSongTrack","array","j","floor","random","shuffleArray","slice","visitCountSr","localStorage","getItem","visitCount","parseInt","sort","a","b","setItem","renderIntro","bodyWrEl","screenWidth","innerEl","introEl","introWidth","targetWidth","startRatio","ratio","vynilEl","displayAudioEffectInit","photoEl","whiteEl","musicSectionEl","codeEl","codeTargetWidth","codeRatio","topEl","j1","j2","j3","addEventListener","vynilTop","innerTop","linksTop","scrollAmount","bgOpacity","backgroundColor","startPoint","opacityStart","opacityStop","visibilityState","location","reload","startEventListener","main"],"sourceRoot":""}